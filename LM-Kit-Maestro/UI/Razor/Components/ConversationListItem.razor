@inherits ComponentBase

<div @onclick="OnSelected" id="item-container" class="@(IsSelected ? "item-selected" : "")">

    <MudTextField Underline=false 
        @ref="ItemTitleRef" 
        @bind-Value="Title" 
        OnKeyDown="OnKeyPressed"
        Immediate="true"
        @onfocusout="OnTitleFocusOut"
        TextUpdateSuppression="false"
        ReadOnly="@(!ViewModel.IsRenaming)"/>

    <div>
        <div id="show-more-button" class="@(IsSelected ? "show" : "hide")">
            <MudIconButton @onclick="OnShowMoreClicked"
                            Icon="@Icons.Material.Filled.MoreHoriz"
                            Size="Size.Small"/>
        </div>

        <MudPopover  Open="@ViewModel.IsShowingActionPopup" Fixed="true">
            <div class="d-flex flex-column">
                <MudButton @onclick="OnRenameClicked">
                    Rename
                </MudButton>

                <MudButton @onclick="OnSelected">
                    Select
                </MudButton>

                <MudButton @onclick="OnDeleteClicked"
                            Color="Color.Error">
                    Delete
                </MudButton>
            </div>
        </MudPopover>

        <MudOverlay @bind-Visible="ViewModel.IsShowingActionPopup"
                    @onclick="OnClickOutsideShowMore" 
                    AutoClose="true" />
    </div>
</div>
